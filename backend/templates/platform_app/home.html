{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>Dashboard</h2>
  <p>Resumen rápido de entornos, cuentas y últimos despliegues.</p>
  <p>
    <a class="btn" href="{% url 'cloudaccount_list' %}">Cuentas cloud</a>
    <a class="btn" href="{% url 'env_list' %}">Entornos</a>
  </p>
</div>

<div class="card">
  <h3>Últimos entornos creados</h3>
  {% if envs %}
  <table>
    <tr>
      <th>Nombre</th><th>Proveedor</th><th>Cluster</th><th>Creado</th>
    </tr>
    {% for e in envs %}
    <tr>
      <td><a href="{% url 'env_detail' slug=e.slug %}">{{ e.name }}</a></td>
      <td>{{ e.cloud_account.get_provider_display|default:"local" }}</td>
      <td>{{ e.get_cluster_type_display }}</td>
      <td>{{ e.created_at }}</td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
  <p>No hay entornos aún.</p>
  {% endif %}
</div>

<div class="card">
  <h3>Últimos despliegues</h3>
  {% if deployments %}
  <table>
    <tr>
      <th>Entorno</th><th>Estado</th><th>Fecha</th>
    </tr>
    {% for d in deployments %}
    <tr>
      <td><a href="{% url 'env_detail' slug=d.environment.slug %}">{{ d.environment.slug }}</a></td>
      <td>{{ d.get_status_display }}</td>
      <td>{{ d.created_at }}</td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
  <p>Aún no se ha lanzado ningún despliegue.</p>
  {% endif %}
</div>
{% endblock %}
